<div class="forecast-top">
  <ul class="tabs-list">
    <li routerLinkActive="active"><a routerLink="/projects">Projects</a></li>
    <li routerLinkActive="active"><a routerLink="/all">Teams</a></li>
  </ul>

  <div class="wrap wrap--accent">
    <button #parentMenu="matMenuTrigger" mat-button (click)="requestParentMenuFocus()" [matMenuTriggerFor]="filterMenu" class="btn btn--default btn--jumbo">{{filterName}}
      <mat-icon svgIcon="drop-down"></mat-icon>
    </button>

    <!-- PRIMARY MENU -->
    <mat-menu [overlapTrigger]="false" #filterMenu="matMenu">
      <button (click)="filter('ap', 'All Projects')" mat-menu-item>All Projects</button>
      <button (click)="filter('pvw', 'View by Projects')" mat-menu-item>View by Projects</button>
      <div *ngFor="let client of filterList">
        <!-- IF NO CHILDREN, NO SUB MENU -->
        <button *ngIf="!checkForChildren(client.projects.length)"
                (click)="filter(client.projects[0].id, client.name + ' - ' + client.projects[0].name)" mat-menu-item>
          {{client.name}}
        </button>
        <!-- IF CHILDREN, THEN SUB MENU -->
        <button *ngIf="checkForChildren(client.projects.length)"
                (click)="requestSubMenuFocus()"
                [matMenuTriggerFor]="projectMenu" mat-menu-item>
          {{client.name}}
          <!-- SUB MENU -->
          <mat-menu [overlapTrigger]="false" #projectMenu="matMenu">
            <button *ngFor="let project of client.projects"
                    (click)="filter(project.id, client.name + ' - ' + project.name)" mat-menu-item>
              {{project.name}}
            </button>
          </mat-menu>
        </button>
      </div>
    </mat-menu>
  </div>
</div>


<div *ngIf="isGraphShowing" class="constrain wrap wrap--spaced">
  <div class="flex-row">
    <div class="flex-column">
      <ul class="financials">
        <li class="financials__item">
          <span>Budget:</span>
          <div class="text-money text-money--jumbo">${{budget | number: '1.0-0'}}</div>
        </li>
        <li class="financials__item">
          <span>Internal Cost to Date:</span>
          <div class="text-money text-money--jumbo">${{internalCost | number: '1.0-0'}}</div>
        </li>
        <li class="financials__item">
          <span>Budget Spent:</span>
          <div class="text-money text-money--jumbo">${{budgetSpent | number: '1.0-0'}}</div>
        </li>
        <li class="financials__item">
          <span>Projected Profit:</span>
          <div class="text-money text-money--jumbo">${{projectedProfit | number: '1.0-0'}}</div>
        </li>
        <li class="financials__item">
          <span>Project Profit Margin:</span>
          <div class="text-money text-money--jumbo">{{projectedProfitMargin | number:'2.2-2'}}%</div>
        </li>
      </ul>
    </div>
    <app-graph [params]="params"></app-graph>
  </div>
</div>


<div class="wrap">
  <app-forecast [height]="height" [isProjectView]="isGraphShowing" [params]="params"
                [forecastHeight]="forecastHeight"></app-forecast>
</div>
