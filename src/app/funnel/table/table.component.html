<div>
  <table class="table-wrapper">
    <thead>
    <tr>
      <th></th>
      <th>Client Name</th>
      <th>New Client?</th>
      <th>Project Name</th>
      <th>Project Manager</th>
      <th>Estimated Revenue</th>
      <th>Confidence</th>
      <th>Status</th>
      <th>Estimated Signing Date</th>
      <th>Signing This Month?</th>
      <th>Projected Start Date</th>
      <th>Starting This Month?</th>
      <th>Project End Date</th>
      <th>Project Duration (weeks)</th>
      <th>Project Duration (months)</th>
      <th>Scala Project Name</th>
      <th>Estimated Monthly Revenue</th>
      <th>Revenue from New Business</th>
      <th>Total Pipeline Revenue</th>
      <th>Completed?</th>
      <th>Notes</th>
    </tr>
    </thead>
    <tbody class="striped-rows">
    <tr *ngFor="let item of funnelItems">

      <td class="utility-buttons">
        <!-- EDIT -->
        <mat-icon [style.cursor]="'pointer'" (click)="edit(item)" svgIcon="edit" title="Edit"></mat-icon>
        <!-- DELETE -->
        <mat-icon [style.cursor]="'pointer'" (click)="remove(item)" svgIcon="delete" title="Delete"></mat-icon>
      </td>

      <!-- CLIENT NAME -->
      <td>
        <div>
          <a href="{{item.URL}}" target="_blank">{{item.client_name}}</a>
        </div>
      </td>

      <!-- NEW CLIENT? -->
      <td>
        <div>
          <mat-select [(ngModel)]="item.is_new_client" name="option" class="yes-no-select">
            <mat-option (click)="update(item)" *ngFor="let option of ynOptions" [value]="option.value">
              {{option.name}}
            </mat-option>
          </mat-select>
        </div>
      </td>

      <!-- PROJECT NAME -->
      <td>
        <div>
          <input [(ngModel)]="item.project_name" (blur)="send(item)" (input)="type(item)" type="text"
                 value="{{item.project_name}}">
        </div>
      </td>

      <!-- PROJECT MANAGER -->
      <td>
        <div>
          <input [(ngModel)]="item.project_manager" (blur)="send(item)" (input)="type(item)" type="text"
                 value="{{item.project_manager}}">
        </div>
      </td>

      <!-- ESTIMATED REVENUE -->
      <td>
        <div>
          <div class="cell-revenue text-money text-right">${{item.revenue | number: '1.2-2'}}</div>
        </div>
      </td>

      <!-- CONFIDENCE -->
      <td>
        <div class="progress progress--confidence progress--positive" [style.width]="item.confidence + 'px'">
          <input class="cell-confidence" [(ngModel)]="item.confidence" (blur)="send(item)" (input)="type(item)"
                 type="number" value="{{item.confidence}}" max="100">
        </div>
      </td>

      <!-- STATUS -->
      <td>
        <div>
          <mat-select class="status-select" [(ngModel)]="item.status" name="option">
            <mat-option (click)="update(item)" *ngFor="let option of statusOptions" [value]="option.value">
              {{option.name}}
            </mat-option>
          </mat-select>
        </div>
      </td>

      <!-- ESTIMATED SIGNING DATE -->
      <td>
        <div>
          <input class="cell-date" [ngModel]="item.signing_date | date: 'MM/dd/yyyy'"
                 (ngModelChange)="changeDate(item, 'signing_date', $event)"
                 (blur)="sendDate(item, 'signing_date', $event.target.value)" type="text">
        </div>
      </td>

      <!-- SIGNING THIS MONTH? -->
      <td class="no-edit">
        <div>
          {{equalsThisMonth(item.signing_date)}}
        </div>
      </td>

      <!-- PROJECTED START DATE -->
      <td>
        <div>
          <input class="cell-date" [ngModel]="item.start_date | date: 'MM/dd/yyyy'"
                 (ngModelChange)="changeDate(item, 'start_date', $event)"
                 (blur)="sendDate(item, 'start_date', $event.target.value)" type="text">
        </div>
      </td>

      <!-- STARTING THIS MONTH? -->
      <td class="no-edit">
        <div>{{equalsThisMonth(item.start_date)}}</div>
      </td>

      <!-- PROJECT END DATE -->
      <td class="no-edit">
        <div>
          {{getEndDate(item.duration_weeks, item.start_date) | date: 'MM/dd/yyyy'}}
        </div>
      </td>

      <!-- PROJECT DURATION (WEEKS) -->
      <td>
        <div>
          <input class="cell-duration-weeks" [(ngModel)]="item.duration_weeks" (blur)="send(item)" (input)="type(item)"
                 type="number"
                 value="{{item.duration_weeks}}">
        </div>
      </td>

      <!-- PROJECT DURATION (MONTHS) -->
      <td>
        <div class="cell-duration-months">{{getDurationMonths(item.duration_weeks) | number: '1.2-2'}}</div>
      </td>

      <!-- SCALA PROJECT NAME -->
      <td>
        <div>
          <mat-select class="project-select" [(ngModel)]="item.project_id" name="project" class="project-name-select">
            <mat-option (click)="update(item)" *ngFor="let project of projects" [value]="project.id">
              {{project.name}}
            </mat-option>
          </mat-select>
        </div>
      </td>

      <!-- ESTIMATED MONTHLY REVENUE -->
      <td class="no-edit">
        <div class="text-money text-right">${{getMonthlyRevenue(item.revenue, item.duration_weeks) | number: '1.2-2'}}
        </div>
      </td>

      <!-- REVENUE FROM NEW BUSINESS -->
      <td class="no-edit">
        <div class="text-money text-right">${{getRevenueFromNewBusiness(item.revenue, item.is_new_client) | number: '1.2-2'}}</div>
      </td>

      <!-- PIPELINE REVENUE -->
      <td class="no-edit">
        <div class="text-money text-right">${{getPipelineRevenue(item.revenue, item.confidence) | number: '1.2-2'}}
        </div>
      </td>

      <!-- COMPLETED? -->
      <td>
        <div>
          <mat-select [(ngModel)]="item.completed" name="option" class="yes-no-select">
            <mat-option (click)="update(item)" *ngFor="let option of ynOptions" [value]="option.value">
              {{option.name}}
            </mat-option>
          </mat-select>
        </div>
      </td>

      <!-- NOTES -->
      <td>
        <div><input [(ngModel)]="item.notes" (blur)="send(item)" (input)="type(item)" type="text"
                    value="{{item.notes}}"></div>
      </td>
    </tr>
    </tbody>
  </table>
</div>
