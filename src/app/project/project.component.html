<div class="forecast-top">
  <ul class="tabs-list">
    <li routerLinkActive="active"><a routerLink="/projects">Projects</a></li>
    <li routerLinkActive="active"><a routerLink="/all">Teams</a></li>
  </ul>

  <div class="wrap wrap--accent">
    <button #parentMenu="matMenuTrigger" mat-button [matMenuTriggerFor]="filter_menu" class="btn btn--default btn--jumbo">{{filterName}}
      <mat-icon svgIcon="drop-down"></mat-icon>
    </button>

    <mat-menu [overlapTrigger]="false" #filter_menu="matMenu">
      <button (click)="filter('ap', 'All Projects')" mat-menu-item><span>All Projects</span></button>
      <button (click)="filter('pvw', 'View by Projects')" mat-menu-item><span>View by Projects</span></button>
      <div *ngFor="let client of filterList">
        <button *ngIf="!checkForChildren(client.projects.length)"
                (click)="filter(client.projects[0].id, client.name + ' - ' + client.projects[0].name)" mat-menu-item>
          <span>{{client.name}}</span>
        </button>
        <button *ngIf="checkForChildren(client.projects.length)" (click)="$event.stopPropagation()"
                [matMenuTriggerFor]="project_menu" mat-menu-item>
          <span>{{client.name}}</span>
          <mat-menu [overlapTrigger]="false" #project_menu="matMenu">
            <button *ngFor="let project of client.projects"
                    (click)="filter(project.id, client.name + ' - ' + project.name)" mat-menu-item="">
              <span>{{project.name}}</span>
            </button>
          </mat-menu>
        </button>
      </div>
    </mat-menu>
  </div>
</div>

<div *ngIf="isGraphShowing" class="constrain wrap wrap--spaced">
  <div class="flex-row">
    <div class="flex-column">
      <ul class="financials">
        <li class="financials__item">
          <span>Budget:</span>
          <div class="text-money text-money--jumbo">${{budget | number: '1.0-0'}}</div>
        </li>
        <li class="financials__item">
          <span>Internal Cost to Date:</span>
          <div class="text-money text-money--jumbo">${{internalCost | number: '1.0-0'}}</div>
        </li>
        <li class="financials__item">
          <span>Budget Spent:</span>
          <div class="text-money text-money--jumbo">${{budgetSpent | number: '1.0-0'}}</div>
        </li>
        <li class="financials__item">
          <span>Projected Profit:</span>
          <div class="text-money text-money--jumbo">${{projectedProfit | number: '1.0-0'}}</div>
        </li>
        <li class="financials__item">
          <span>Project Profit Margin:</span>
          <div class="text-money text-money--jumbo">{{projectedProfitMargin | number:'2.2-2'}}%</div>
        </li>
      </ul>
    </div>
    <app-graph [params]="params"></app-graph>
  </div>
</div>


<div class="wrap">
  <app-forecast [height]="height" [isProjectView]="isGraphShowing" [params]="params" [forecastHeight]="forecastHeight"></app-forecast>
</div>
